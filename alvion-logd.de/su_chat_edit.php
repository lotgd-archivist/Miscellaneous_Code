
<?php// Admin-Chat-Edit.php by Linus in 2010require_once "common.php";page_header("User-Beitrag editieren");output("`b`cBeitrag editieren:`c`b`n`n");$backto=$_GET['backto'];switch($_GET['op']){    case 'save':        $beitrag_neu = mysqli_real_escape_string($mysqli, stripslashes($_POST['editedchat']));        $commid = $_POST['commid'];        $sql = "UPDATE commentary SET comment = '".$beitrag_neu."' WHERE commentid = ".$commid;        db_query($sql);        $backto = preg_replace("'[&?]c=[[:digit:]-]+'","",$backto);        $backto = substr($backto,strrpos($backto,"/")+1);        redirect("$backto");    break;    default:        $sql = "SELECT * FROM commentary WHERE commentid = ".$_GET['commentid'];        $result = db_query($sql);        if (db_num_rows($result)<=0){            output("Der Post existiert nicht, oder es ist ein Fehler aufgetreten.");        }else{            $row = db_fetch_assoc($result);            $beitrag = $row['comment'];            $commid = $row['commentid'];            $output.="<form action='su_chat_edit.php?op=save&backto=".$backto."&commentid=".$_GET['commentid']."' method='POST'><textarea name='editedchat' class='input' cols='100' rows='20'>".HTMLSpecialChars($beitrag)."</textarea><br><input type='hidden' name='commid' value=\"".$commid."\"> <input type='submit' value='Ändern'></form>";            allownav("su_chat_edit.php?op=save&backto=$backto&commentid=".$_GET['commentid']);        }        $backto = preg_replace("'[&?]c=[[:digit:]-]+'","",$backto);        $backto = substr($backto,strrpos($backto,"/")+1);        addnav("Zurück",$backto);    break;}page_footer();

