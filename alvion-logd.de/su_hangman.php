
<?php/** Version:    27.04.2008* Author:    Linus (schamlos abgkupfert von suhouses.php by anpera und Chaosmaker)* Email:    webmaster@alvion-logd.de* Zweck:    Admintool für die persönlichen Schatzkammern**/require_once("common.php");require_once "func/isnewday.php";isnewday(3);function analyse(){    $accts=array();    $sql="SELECT `acctid` FROM `accounts`";    $result=db_query($sql);    while ($row = db_fetch_assoc($result)) {        $accts[$i]=(int)$row['acctid'];        $i++;    }    $gut=0;    $fehl=0;    $sql="SELECT `best` FROM `hangman_txt`";    $result=db_query($sql);    while ($row = db_fetch_assoc($result)) {        if(in_array((int)$row['best'],$accts)){            $gut++;        }elseif ($row['best']!=''){            $fehl++;        }        $j++;    }    return array($j, $gut, $fehl);}page_header("Hangmanrekorde");switch($_GET['op']){    case "delete":        $accts=array();        $sql="SELECT `acctid` FROM `accounts`";        $result=db_query($sql);        while ($row = db_fetch_assoc($result)) {            $accts[$i]=(int)$row['acctid'];            $i++;        }        $gut=0;        $fehl=0;        $sql="SELECT * FROM `hangman_txt`";        $result=db_query($sql);        while ($row = db_fetch_assoc($result)) {            if(in_array((int)$row['best'],$accts) || ($row['best']=='' && $row['name']=='' && $row['time']==0 && $row['errors']==6)){                $gut++;            }else{                $fehl++;                db_query("UPDATE `hangman_txt` SET `best`='', `errors`=6, `time`=0, `name`='' where `id`=".(int)$row['id']);            }            $j++;        }        output("`&".$fehl." Rekordhalter wurden gelöscht`n");        addnav('Zurück','su_hangman.php?');    break;    default:        list($j, $gut, $fehl)=analyse();        if($fehl>0) addnav('unnütze Rekorde löschen','su_hangman.php?op=delete');//        addnav('','su_hangman.php?op=edit');        output("`@`b`cDie Hangmanrekorde`c`b`n`n            `7Anzahl Wörter gesamt: `@".$j."`n`7Rekorde von existierenden Spielern: `@".$gut."`n`7Rekorde von gelöschten Spielern: `@".$fehl."`n`n");    break;}addnav("G?Zurück zur Grotte","superuser.php");addnav("W?Zurück zum Weltlichen","village.php");output("`n<div align='right'>`72008 by Linus for alvion-logd.de/logd</div>",true);page_footer();?>

