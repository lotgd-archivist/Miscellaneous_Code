
<?phprequire_once "common.php";addcommentary();checkday();page_header("Dorfschmiede");$session['user']['standort']="dorfschmiede";function checkupdate($art) {    global $session;    if (strchr($session['user'][$art],"Final Touch")){        $erg='final';    }else if (strchr($session['user'][$art],"High-Grade") && strchr($session['user'][$art],"Up-Grade") && strchr($session['user'][$art],"Power")){         $erg='ja';    }else{            $erg='nein';    }    return $erg;}    function weapon_armor_update($art, $kosten) {        global $session;    if($art=='weapon'){        $newweapon =$session['user']['weapon']." `^mit Final Touch`0";        $session['user']['weapon']=$newweapon;        $session['user']['weapondmg']+=5;        $session['user']['weaponvalue']+=$kosten;        $session['user']['attack']+=5;    }else{        $newarmor =$session['user']['armor']." `^mit Final Touch`0";        $session['user']['armor']=$newarmor;        $session['user']['armordef']+=5;        $session['user']['armorvalue']+=$kosten;        $session['user']['defence']+=5;    }    $session['user']['gold']-=$kosten;}switch($_GET['op']){    case 'waffe':        $out="`&Du zeigst `&D`=o`Yr`Di`Èo`*n `&deine Waffe und sagst, dass du sie gerne verbessert haben möchtest. Er wirft einen kurzen Blick auf die Klinge und ";        $do=checkupdate('weapon');        switch($do){            case 'final':                $out.="ein Lächeln zeigt sich auf seinem Gesicht. `D\"Du warst schon mal hier    ".($session['user']['sex']?"werte Freundin":"mein Freund").". ";                $out.="Dein `^".$session['user']['weapon']."`D hat bereits den letzten Schliff, da kann selbst ich nichts mehr machen!\"`n";                break;            case 'nein':                $out.="schüttelt bedauernd den Kopf. ";                $out.="`D\"Dein `^".$session['user']['weapon']."`D ist noch nicht bereit für den letzten Schliff!\"`n";                break;            case 'ja':                $newdmg=$session['user']['weapondmg']+5;                $cost =$session['user']['weapondmg']*500;                $out.="nickt. `D\"Für `^$cost `DGoldstücke könnte ich `^".$session['user']['weapon']."`D den letzten Schliff verpassen, und die Waffe auf eine Stärke von $newdmg Schaden bringen.\"`n";                addnav("Ja, das will ich!","dorfschmiede.php?op=update&typ=weapon");                break;        }        break;    case 'ruestung':        $out="`&Du zeigst `&D`=o`Yr`Di`Èo`*n `&deine Rüstung und sagst, dass du sie gerne verbessert haben möchtest. Er wirft einen kurzen Blick auf die den Panzer und ";        $do=checkupdate('armor');        switch($do){            case 'final':                $out.="ein Lächeln zeigt sich auf seinem Gesicht. `D\"Du warst schon mal hier    ".($session['user']['sex']?"werte Freundin":"mein Freund").". ";                $out.="Dein `^".$session['user']['armor']."`D hat bereits den letzten Schliff, da kann selbst ich nichts mehr machen!\"`n";                break;            case 'nein':                $out.="schüttelt bedauernd den Kopf. ";                $out.="`D\"Dein `^".$session['user']['armor']."`D ist noch nicht bereit für den letzten Schliff!\"`n";                break;            case 'ja':                $newdmg=$session['user']['armordef']+5;                $cost =$session['user']['armordef']*500;                $out.="nickt. `D\"Für `^$cost `DGoldstücke könnte ich `^".$session['user']['armor']."`D den letzten Schliff verpassen, und die Rüstung auf eine Stärke von $newdmg Abwehr bringen.\"`n";                addnav("Ja, das will ich!","dorfschmiede.php?op=update&typ=armor");                break;        }        break;    case 'update':        $typ=$_GET['typ'];        if($typ=='weapon'){            $newdmg=$session['user']['weapondmg']+5;            $cost =$session['user']['weapondmg']*500;        }else if ($typ=='armor'){            $newdmg=$session['user']['armordef']+5;            $cost =$session['user']['armordef']*500;        }else{            $out="`$Ein Fehler ist aufgetreten. Berschwer dich bitte bei Linus!`n";        }        if($session['user']['gold']<$cost){            $out="`&D`=o`Yr`Di`Èo`*n `&schaut ziehmlich verärgert, da du die geforderten`^ $cost`& Goldstücke nicht zahlen kannst. `D\"Besorg dir erst die nötigen Geldmittel ";            $out.="wenn du meine Dienste in Anspruch nehmen willst!\" `&brummt er und weist dir den Weg zur Tür.`n";        }else{            $out="`&D`=o`Yr`Di`Èo`*n `&nimmt die geforderten `^$cost`& Goldstücke entgegen und verschwindet mit deiner/m ".$session['user'][$typ]."`& im Hinterzimmer. ";            weapon_armor_update($typ, $cost);            $out.="Es dauert eine kleine Ewigkeit bis er zurück kommt und dir mit strahlenden Augen ".$session['user'][$typ]." `&überreicht.`n";        }            break;                    case '':        $ops=TRUE;        $out="`b`c`*D`Èo`Dr`Yf`=s`&ch`=m`Yi`De`Èd`*e`0`b`c`n`n";        $out.="`*B`Èe`Di`Ym `=b`&etreten der Schmiede schlägt dir gleich die Hitze des Schmiedefeuers entgegen und du brauchst einen Moment um dich an das Licht im Inneren der großen Hütte zu gew`=ö`Yh`Dn`Èe`*n. ";        $out.="A`Èm `DF`Ye`=u`&er steht ein großer Mann, der mit seinem Hammer das heiße Eisen bearbeitet, an den Wänden hängen Schilde und Schwerter in verschiedenen G`=r`Yö`Dß`Èe`*n. ";        $out.="M`Èa`Dn`Yc`=h`&e sind verziert, einige eher schlicht gehalten, aber man erkennt die Kunstfertigkeit des Schmieds, der nun seine Arbeit zur Seite legt und sich dir zuw`=e`Yn`Dd`Èe`*t. ";        $out.="E`Èi`Dn`Ye`=n `&Moment lang nimmst du dir noch die Zeit und bewunderst die große Ritterrüstung die in einer Ecke steht und träumst davon ebenfalls irgendwann so etwas wertvolles zu besitzen und in den Kampf mit den grünen Drachen zu z`=i`Ye`Dh`Èe`*n. ";        $out.="D`Èa`Dn`Yn `=j`&edoch wendest du dich davon ab um mit dem Schmied über dein Anliegen zu spr`=e`Yc`Dh`Èe`*n. ";//        if($session['user']['rp_only']==0){            addnav("Waffe verbessern","dorfschmiede.php?op=waffe");            addnav("Rüstung verbessern","dorfschmiede.php?op=ruestung");//        }    break;}$out.="`n`n";output($out,true);if ($ops){    viewcommentary("Dorfschmiede","Hinzufügen",25,"sagt",1,1);    navhead("Zurück");                                   addnav("Mysteriöses Eck","mysterioeses_eck.php");} else{    navhead("Zurück");                                   addnav("Zurück","dorfschmiede.php");}page_footer();

