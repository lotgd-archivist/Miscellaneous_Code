
<?php/** Geschenkestand für das Samhainfest* von Freya, Jilia, Ainaredien und Linus in 20011* für http://www.alvion-logd.de/logd/*/require_once "common.php";require_once "func/systemmail.php";page_header("Geschenkestand");$geschenk=array(0=>array('ohne'=>'Spinnennetz', 'mit'=>'`àS`up`~i`àn`un`àe`~n`un`àe`ut`àz`0', 'preis'=>200, 'artikel'=>'ein')                , 1=>array('ohne'=>'Fackel', 'mit'=>'`$F`qa`^ck`qe`$l`0', 'preis'=>300, 'artikel'=>'eine')                , 2=>array('ohne'=>'Kessel', 'mit'=>'`)K`èe`às`us`~el`0', 'preis'=>500, 'artikel'=>'einen')                , 3=>array('ohne'=>'Fledermaus', 'mit'=>'`TAu`Bsg`Cesto`Bpf`Tte `TFle`Bder`Cmau`Bs`0', 'preis'=>500, 'artikel'=>'eine')                , 4=>array('ohne'=>'Knochen', 'mit'=>'`)Kn`7oc`=he`&n`0', 'preis'=>500, 'artikel'=>'einen')                , 5=>array('ohne'=>'Kürbis', 'mit'=>'`QK`qü`Qr`qb`Qi`qs`0', 'preis'=>800, 'artikel'=>'einen')                , 6=>array('ohne'=>'Spitzhut', 'mit'=>'`jSp`Úit`Ízh`Éut`0', 'preis'=>1000, 'artikel'=>'einen')                , 7=>array('ohne'=>'Geisterketten', 'mit'=>'`)Ge`7i`=st`&erk`=et`7t`)en`0', 'preis'=>1500, 'artikel'=>'')                );                $beschreibung=array(0=>array('inv'=>'`QEin Netz, das dich schmeichelnd einhüllen kann. Ein Geschenk von', 'gesch'=>'`~Ein wundervolles, klebriges Spinnennetz macht sich wirklich gut.')                , 1=>array('inv'=>'`QEine Fackel, die dir immer den Weg leuchtet. Ein Geschenk von', 'gesch'=>'`QEine Fackel, die sich wirklich sehen lassen kann. Du kannst dir schon gut vorstellen, wie sie einen Raum erhellt und ein sanftes Licht spendet. ')                , 2=>array('inv'=>'`QEin Kessel, ideal zum Kürbisse kochen. Ein Geschenk von', 'gesch'=>'`èDen Kessel kann man sicher für etwaige experimentelle Dinge nutzen oder eben einfach zum Köcheln.')                , 3=>array('inv'=>'`QEine Fledermaus, die dich das Gruseln lehren könnte. Ein Geschenk von', 'gesch'=>'`BDie ausgestopfte Fledermaus macht sich hier hervorragend. Ein wirklich tolles Geschenk zum Samhainfest, das musst du schon zugeben, wenn auch ebenso außergewöhnlich.')                , 4=>array('inv'=>'`QEin Knochen - von wem der wohl ist? Ein Geschenk von', 'gesch'=>'`=Ein bisschen gruselig sind diese Knochen ja schon, das sollen sie ja schließlich auch und erfüllen diesbezüglich auf jeden Fall ihren Zweck.')                , 5=>array('inv'=>'`QEin Kürbis - unabdingbar zu Samhain! Ein Geschenk von', 'gesch'=>'`qEin schöner großer Kürbis. Ein schönes Geschenk zum Samhainfest!')                , 6=>array('inv'=>'`QEin Spitzhut - von der Hexe vielleicht? Ein Geschenk von', 'gesch'=>'`ÚDieser Hut macht sich sicher nicht nur auf dem Samhainfest gut, man kann ihn bestimmt auch noch zu anderen Anlässen tragen.')                , 7=>array('inv'=>'`QGeisterketten - was ihr Rascheln wohl sagen will? Ein Geschenk von', 'gesch'=>'`)Genau das richtige hier sind die Geisterketten. Sie können einen schon ganz schön das Fürchten lehren.')                );        $out="`n`c`b`uG`àe`ès`)c`7h`=e`_n`§k`Xe`Ns`Qta`qnd`0`b`c`n`n";switch($_GET['op']){    case 'send':        $gift=$_GET['gift'];        if (isset($_POST['search']) || $_GET['search']>""){            if ($_GET['search']>"") $_POST['search']=$_GET['search'];            $search="%";            for ($x=0;$x<strlen($_POST['search']);$x++){                $search .= substr($_POST['search'],$x,1)."%";            }            $search="name LIKE '".$search."' AND ";            if ($_POST['search']=="weiblich") $search="sex=1 AND ";            if ($_POST['search']=="männlich") $search="sex=0 AND ";        }else{            $search="";        }        $ppp=25; // Player Per Page to display        if (!$_GET[limit]){            $page=0;        }else{            $page=(int)$_GET[limit];            addnav("Vorherige Seite","samhain_geschenke.php?op=send&gift=$gift&limit=".($page-1)."&search=$_POST[search]");        }        $limit="".($page*$ppp).",".($ppp+1);        $sql = "SELECT login,name,level,sex,acctid FROM accounts WHERE $search locked=0 AND acctid<>".$session[user][acctid]." AND lastip<>'".$session[user][lastip]."' AND charm>1 ORDER BY login,level LIMIT $limit";        $result = db_query($sql);        if (db_num_rows($result)>$ppp) addnav("Nächste Seite","samhain_geschenke.php?op=send&gift=$gift&limit=".($page+1)."&search=$_POST[search]");        $out.="`QWem willst du ".$geschenk[$gift]['mit']."`Q schicken?`n`n";        $out.="<form action='samhain_geschenke.php?op=send&gift=$gift' method='POST'>Nach Name suchen: <input name='search' value='$_POST[search]'><input type='submit' class='button' value='Suchen'></form>";        allownav("samhain_geschenke.php?op=send&gift=$gift");        $out.="<table cellpadding='3' cellspacing='0' border='0'><tr class='trhead'><td>Name</td><td>Level</td><td>Geschlecht</td></tr>";        for ($i=0;$i<db_num_rows($result);$i++){            $row = db_fetch_assoc($result);            $out.="<tr class='".($i%2?"trlight":"trdark")."'><td><a href='samhain_geschenke.php?op=send2&gift=$gift&name=".HTMLSpecialChars($row['acctid'])."'>";            $out.=$row['name'];            $out.="</a></td><td>";            $out.=$row['level'];            $out.="</td><td align='center'><img src='images/".($row['sex']?"female":"male").".gif'></td></tr>";            addnav("","samhain_geschenke.php?op=send2&gift=$gift&name=".HTMLSpecialChars($row['acctid']));        }        $out.="</table>";    break;        case 'send2':        $name=$_GET['name'];        $gift=$_GET['gift'];        db_query("INSERT INTO items (name,owner,class,gold,description) VALUES ('".$geschenk[$gift]['mit']."',$name,'Geschenk',".$geschenk[$gift]['preis'].",'".$beschreibung[$gift]['inv']." ".mysqli_real_escape_string($mysqli, $session['user']['name'])."')");        $session[user][gold]-=$geschenk[$gift]['preis'];        $out.="`QDu hast dich nach reichlicher Überlegung dazu entschieden, ".$geschenk[$gift]['artikel']." ".$geschenk[$gift]['mit']."`Q zu kaufen. ";        $out.="Die alte Gewitterhexe nickt, als du ihr die Goldstücke für dieses Präsent reichst und kichert gehässig in ";        $out.="sich hinein, während sie das Geschenk für dich einpackt. Es dauert nicht lange und dein Geschenk wird ";        $out.="auf die Reise geschickt.";                $mailmessage="`&".$session['user']['name'];        $mailmessage.="`Q hat dir ein Geschenk geschickt. Du öffnest es. Du findest ".$geschenk[$gift]['artikel']." ";        $mailmessage.=$geschenk[$gift]['mit'];        //you can change the following the match what you name your gift shop        $mailmessage.="`Q vom Samhainfest.`n";        systemmail($name,"`QGeschenk erhalten!",$mailmessage);        addnav("Mehr Geschenke","samhain_geschenke.php");    break;        default:        $out.="`XDu `qha`Qst dich dazu entschlossen den Geschenkestand genauer in Augenschein zu nehmen und schaust dich hier ganz ";        $out.="genau um. Die alte Gewitterhexe, die dahinter steht, ist dir nicht ganz geheuer, aber du willst dich ja auch nicht ";        $out.="mit ihr anfreunden, sondern einem guten Freund oder ".($session['user']['sex']?'deinem':'deiner')." Liebsten ein ";        $out.="Geschenk zu diesem schönen Samhainfest machen. Neugierig lässt du den Blick über die Dinge schweifen, die hier ";        $out.="angeboten we`qrd`Xen.`Q`n`n`n                    <table align=\"center\"><div align=\"left\"><ul>";        $out.="<table align=\"center\"><div align=\"left\"><ul>";        for($i=0;$i<count($geschenk);$i++){            if ($session['user']['gold'] >= $geschenk[$i]['preis']){                $out.="<li><a href=\"samhain_geschenke.php?op=send&gift=$i\">".$geschenk[$i]['mit']." `&- ".$geschenk[$i]['preis']." Goldstücke</a>                    <br />".$beschreibung[$i]['gesch']."</li>";                allownav("samhain_geschenke.php?op=send&gift=$i");                addnav($geschenk[$i]['ohne'],"samhain_geschenke.php?op=send&gift=$i");            }        }        $out.="</ul></div></table>`n`n";}                navhead("`bZurück`b");addnav("Zurück","samhain.php");output($out,true);page_footer();

