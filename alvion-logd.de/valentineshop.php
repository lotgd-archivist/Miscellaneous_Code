
<?php// 10092004// created by Lonny Luberts for http://www.pqcomp.com/logd, built on idea from quest's giftshop with all new code.// this file needs customization before use and is designed to be added in many places if need be// as different gift shops.// search and replace (valentineshop.php) with what you name the giftshop php file// search and replace (gift 1)-(your gift) with your gifts - make sure you use the space inbetween gift & 1 etc...// if you do an auto replace with your editor.// be sure to edit the return nav// please feel free to use and edit this file, any major upgrades or improvements should be// mailed to logd@pqcomp.com for consideration as a permenant inclusion// please do not remove the comments from this file.// Version: 03212004//// changes to fit ext (GER) and translation by anpera// added items with buffs//modifiziert zum Laden für Valentins-Geschenke von Linus für alvion-logd.de/logdrequire_once "common.php";require_once "func/systemmail.php";checkday();page_header("Valentins Geschenkeladen");$out="`c`b`&Valentins Geschenkeladen`0`b`c`n`n";if ($_GET[op]=="" && $session[user][turns]>0){    $out.="`rDu betrittst den Geschenkeladen und siehst eine Menge einzigartiger Gegenstände.`n";    $out.="Ein".($session[user][sex]?" junger Mann":"e junge Frau")." steht hinter der Ladentheke und lächelt dich sanft an.`n";    $out.="Ein Schild an der Wand verspricht \"`iGeschenkverpackung und Lieferung frei.`i\"`n";    $out.="`n<ul>";    if ($session[user][gold] > 10){        addnav("`tHe`Urz`Jpra`Ulin`ten`0 - 10 Gold","valentineshop.php?op=send&op2=gift2");        $out.="<a href=\"valentineshop.php?op=send&op2=gift2\">`tHe`Urz`Jpra`Ulin`ten`0 - 10 Gold</a><br>";        addnav("","valentineshop.php?op=send&op2=gift2");        addnav("`BLe`tbkuchenhe`Brz`0 - 10 Gold","valentineshop.php?op=send&op2=gift3");        $out.="<a href=\"valentineshop.php?op=send&op2=gift3\">`BLe`tbkuchenhe`Brz`0 - 10 Gold</a><br>";        addnav("","valentineshop.php?op=send&op2=gift3");    }    if ($session[user][gold] > 20){        addnav("`\$Ro`kse`Jnst`krau`\$ß`0 - 20 Gold","valentineshop.php?op=send&op2=gift4");        $out.="<a href=\"valentineshop.php?op=send&op2=gift4\">`\$Ro`kse`Jnst`krau`\$ß`0 - 20 Gold</a><br>";        addnav("","valentineshop.php?op=send&op2=gift4");    }    if ($session[user][gold] > 30){        addnav("`2Bu`^nt`9er `kBl`%um`qen`!str`rau`&ß`0 - 30 Gold","valentineshop.php?op=send&op2=gift5");        $out.="<a href=\"valentineshop.php?op=send&op2=gift5\">`2Bu`^nt`9er `kBl`%um`qen`!str`rau`&ß`0 - 30 Gold</a><br>";        addnav("","valentineshop.php?op=send&op2=gift5");    }    if ($session[user][gold] > 40){        addnav("`ASt`%off`rti`Rer`rhe`%r`Az`0 - 40 Gold","valentineshop.php?op=send&op2=gift6");        $out.="<a href=\"valentineshop.php?op=send&op2=gift6\">`ASt`%off`rti`Rer`rhe`%r`Az`0 - 40 Gold</a><br>";        addnav("","valentineshop.php?op=send&op2=gift6");    }    if ($session[user][gold] > 50){        addnav("`9Sekt`#flasche`0 - 50 Gold","valentineshop.php?op=send&op2=gift7");        $out.="<a href=\"valentineshop.php?op=send&op2=gift7\">`9Sekt`#flasche`0 - 50 Gold</a><br>";        addnav("","valentineshop.php?op=send&op2=gift7");    }    if ($session[user][gold] > 80 && $session[user][marriedto]>0 && $session[user][marriedto]!=4294967295 ){        if($session['user']['sex']==0){            addnav("`\$K`Oette `\$m`Oit `\$d`Oer `\$I`Onschrift `\$d`Oes `\$L`Oiebsten`0 - 80 Gold","valentineshop.php?op=send&op2=gift8");            $out.="<a href=\"valentineshop.php?op=send&op2=gift8\">`\$K`Oette `\$m`Oit `\$d`Oer `\$I`Onschrift `\$d`Oes `\$L`Oiebsten`0 - 80 Gold</a><br>";        } else {            addnav("`\$K`Oette `\$m`Oit `\$d`Oer `\$I`Onschrift `\$d`Oer `\$L`Oiebsten`0 - 80 Gold","valentineshop.php?op=send&op2=gift8");            $out.="<a href=\"valentineshop.php?op=send&op2=gift8\">`\$K`Oette `\$m`Oit `\$d`Oer `\$I`Onschrift `\$d`Oer `\$L`Oiebsten`0 - 80 Gold</a><br>";        }        addnav("","valentineshop.php?op=send&op2=gift8");    }    if ($session[user][gold] > 100){        addnav("`5K`rus`Zche`rl`5s`re`Zt`0 - 100 Gold","valentineshop.php?op=send&op2=gift9");        $out.="<a href=\"valentineshop.php?op=send&op2=gift9\">`5K`rus`Zche`rl`5s`re`Zt`0 - 100 Gold</a><br>";        addnav("","valentineshop.php?op=send&op2=gift9");    }    if ($session[user][gold] > 120){        addnav("`%Duf`rtker`Rzen `%in `rHer`Rzf`%orm`0 - 120 Gold","valentineshop.php?op=send&op2=gift10");        $out.="<a href=\"valentineshop.php?op=send&op2=gift10\">`%Duf`rtker`Rzen `%in `rHer`Rzf`%orm`0 - 120 Gold</a><br>";        addnav("","valentineshop.php?op=send&op2=gift10");    }    if ($session[user][gold] > 150){        addnav("`9Te`#ddy`9b`#är`0 - 150 Gold","valentineshop.php?op=send&op2=gift11");        $out.="<a href=\"valentineshop.php?op=send&op2=gift11\">`9Te`#ddy`9b`#är`0 - 150 Gold</a><br>";        addnav("","valentineshop.php?op=send&op2=gift11");    }    if ($session[user][gold] > 200){        addnav("`AG`&utschein für ein schönes Essen zu Zwei`At`0 - 200 Gold","valentineshop.php?op=send&op2=gift12");        $out.="<a href=\"valentineshop.php?op=send&op2=gift12\">`AG`&utschein für ein schönes Essen zu Zwei`At`0 - 200 Gold</a><br>";        addnav("","valentineshop.php?op=send&op2=gift12");        addnav("`AG`Rutschein für ein romantisches Picknic`Ak`0 - 200 Gold","valentineshop.php?op=send&op2=gift13");        $out.="<a href=\"valentineshop.php?op=send&op2=gift13\">`AG`Rutschein für ein romantisches Picknic`Ak`0 - 200 Gold</a><br>";        addnav("","valentineshop.php?op=send&op2=gift13");        addnav("`\$G`^utschein für ein Dinner bei Kerzenlich`\$t`0 - 200 Gold","valentineshop.php?op=send&op2=gift14");        $out.="<a href=\"valentineshop.php?op=send&op2=gift14\">`\$G`^utschein für ein Dinner bei Kerzenlich`\$t`0 - 200 Gold</a><br>";        addnav("","valentineshop.php?op=send&op2=gift14");        addnav("`2G`^utschein für extra Streicheleinheite`2n`0 - 200 Gold","valentineshop.php?op=send&op2=gift15");        $out.="<a href=\"valentineshop.php?op=send&op2=gift15\">`2G`^utschein für extra Streicheleinheite`2n`0 - 200 Gold</a><br>";        addnav("","valentineshop.php?op=send&op2=gift15");    }    $out.="</ul>";    addnav("Sonstiges");    // change this nav to return to the location you call it from    addnav("Zurück zum Marktplatz","marktplatz.php");}else if ($session[user][turns]<=0){    $out.="`rDer Laden hat jetzt leider schon geschlossen.";    addnav("Z?Zurück zum Marktplatz","marktplatz.php");    addnav("u?Zurück zum Dorf","village.php");}if ($_GET[op]=="send"){    $gift=$_GET[op2];    if($gift=="gift8"){        $sql = "SELECT login,name,level,sex,acctid FROM accounts WHERE locked=0 AND acctid='".$session[user][marriedto]."' AND acctid<>".$session[user][acctid]." AND lastip<>'".$session[user][lastip]."'";        $result = db_query($sql);        if (db_num_rows($result)==1){            $row = db_fetch_assoc($result);//            $out.="Willst du $row[name] diese Kette schenken?";            $out.='<a href="valentineshop.php?op=send2&op2=gift8&name='.$row['acctid'].'"> '.$row[name].'`0 diese Kette schenken?</a>';            addnav("","valentineshop.php?op=send2&op2=gift8&name={$row['acctid']}");            addnav("Z?Zurück","valentineshop.php");        } else {            $out.="`rIch konnte niemanden finden.";            addnav("Z?Zurück zum Marktplatz","marktplatz.php");            addnav("u?Zurück zum Dorf","village.php");        }    } else {        if (isset($_POST['search']) || $_GET['search']>""){            if ($_GET['search']>"") $_POST['search']=$_GET['search'];            $search="%";            for ($x=0;$x<strlen($_POST['search']);$x++){                $search .= substr($_POST['search'],$x,1)."%";            }            $search="name LIKE '".$search."' AND ";//            if ($_POST['search']=="weiblich") $search="sex=1 AND ";//            if ($_POST['search']=="männlich") $search="sex=0 AND ";        }else{            $search="";        }        $ppp=25; // Player Per Page to display        if (!$_GET[limit]){            $page=0;        }else{            $page=(int)$_GET[limit];            addnav("Vorherige Seite","valentineshop.php?op=send&op2=$gift&limit=".($page-1)."&search=$_POST[search]");        }        $limit="".($page*$ppp).",".($ppp+1);        $sql = "SELECT login,name,level,sex,acctid FROM accounts WHERE $search locked=0 AND acctid<>".$session[user][acctid]." AND lastip<>'".$session[user][lastip]."' AND charm>1 ORDER BY login,level LIMIT $limit";        $result = db_query($sql);        if (db_num_rows($result)>$ppp) addnav("Nächste Seite","valentineshop.php?op=send&op2=$gift&limit=".($page+1)."&search=$_POST[search]");        $out.="`rWem willst du das Geschenk schicken?`n`n";        $out.="<form action='valentineshop.php?op=send&op2=$gift' method='POST'>Nach Name suchen: <input name='search' value='$_POST[search]'><input type='submit' class='button' value='Suchen'></form>";        addnav("","valentineshop.php?op=send&op2=$gift");        $out.="<table cellpadding='3' cellspacing='0' border='0'><tr class='trhead'><td>Name</td><td>Level</td><td>Geschlecht</td></tr>";        for ($i=0;$i<db_num_rows($result);$i++){            $row = db_fetch_assoc($result);            $out.="<tr class='".($i%2?"trlight":"trdark")."'><td><a href='valentineshop.php?op=send2&op2=$gift&name=".HTMLSpecialChars($row['acctid'])."'>";            $out.=$row['name'];            $out.="</a></td><td>";            $out.=$row['level'];            $out.="</td><td align='center'><img src='images/".($row['sex']?"female":"male").".gif'></td></tr>";            addnav("","valentineshop.php?op=send2&op2=$gift&name=".HTMLSpecialChars($row['acctid']));        }        $out.="</table>";        addnav("Zurück zum Laden","valentineshop.php");    }}if ($_GET[op]=="send2"){    $name=$_GET[name];    $effekt="";    if ($_GET[op2]=="gift2"){        $gift="`tHe`Urz`Jpra`Ulin`ten`";        $effekt="Natürlich futterst du sie sofort alle auf.";        $session[user][gold]-=10;    }    if ($_GET[op2]=="gift3"){        $gift="`BLe`tbkuchenhe`Brz";        $effekt="Natürlich futterst du es sofort auf.";        $session[user][gold]-=10;    }    if ($_GET[op2]=="gift4"){        $gift="`\$Ro`kse`Jnst`krau`\$ß";        $session[user][gold]-=20;    }    if ($_GET[op2]=="gift5"){        $gift="`2Bu`^nt`9er `kBl`%um`qen`!str`rau`&ß";        $session[user][gold]-=30;    }    if ($_GET[op2]=="gift6"){        $gift="`ASt`%off`rti`Rer`rhe`%r`Az`";        db_query("INSERT INTO items (name,owner,class,gold,description) VALUES ('`ASt`%off`rti`Rer`rhe`%r`Az`0',$name,'Geschenk',20,'Ein Valentinsgeschenk von ".mysqli_real_escape_string($mysqli, $session[user][name])."')");        $session[user][gold]-=40;    }    if ($_GET[op2]=="gift7"){        $gift="`9Sekt`#flasche";        $effekt="Natürlich läßt du sofort den Korken knallen und genießt das prickelnde Getränk.";        $session[user][gold]-=50;    }    if ($_GET[op2]=="gift8"){        if($session['user']['sex']==0){            $gift="`\$K`Oette `\$m`Oit `\$d`Oer `\$I`Onschrift `\$d`Oes `\$L`Oiebsten";            db_query("INSERT INTO items (name,owner,class,gold,description) VALUES ('`\$K`Oette `\$m`Oit `\$d`Oer `\$I`Onschrift `\$d`Oes `\$L`Oiebsten`0',$name,'Geschenk',100,'Ein Valentinsgeschenk mit einer Inschrift von ".mysqli_real_escape_string($mysqli, $session[user][name]).".')");        } else {            $gift="`\$K`Oette `\$m`Oit `\$d`Oer `\$I`Onschrift `\$d`Oer `\$L`Oiebsten";            db_query("INSERT INTO items (name,owner,class,gold,description) VALUES ('`\$K`Oette `\$m`Oit `\$d`Oer `\$I`Onschrift `\$d`Oer `\$L`Oiebsten`0',$name,'Geschenk',100,'Ein Valentinsgeschenk mit einer Inschrift von ".mysqli_real_escape_string($mysqli, $session[user][name]).".')");        }            $session[user][gold]-=80;    }    if ($_GET[op2]=="gift9"){        $gift="`5K`rus`Zche`rl`5s`re`Zt";        db_query("INSERT INTO items (name,owner,class,gold,description) VALUES ('`5K`rus`Zche`rl`5s`re`Zt`0',$name,'Geschenk',100,'Ein Set aus Herzkissen und Plüschtieren. Ein Valentinsgeschenk von ".mysqli_real_escape_string($mysqli, $session[user][name])."')");        $session[user][gold]-=100;    }    if ($_GET[op2]=="gift10"){        $gift="`%Duf`rtker`Rzen `%in `rHer`Rzf`%orm";        db_query("INSERT INTO items (name,owner,class,gold,description) VALUES ('`%Duf`rtker`Rzen `%in `rHer`Rzf`%orm`0',$name,'Geschenk',100,'Ein Valentinsgeschenk von ".mysqli_real_escape_string($mysqli, $session[user][name])."')");        $session[user][gold]-=120;    }    if ($_GET[op2]=="gift11"){        $gift="`9Te`#ddy`9b`#är";        $effekt="`RDer ist ja soooooo süüüüüüüüüüüssss!!!`0";        db_query("INSERT INTO items (name,owner,class,gold,description) VALUES ('`9Te`#ddy`9b`#är`0',$name,'Geschenk',100,'Ein Plüschteddy zum Kuscheln. Der ist von ".mysqli_real_escape_string($mysqli, $session[user][name])."')");        $session[user][gold]-=150;    }    if ($_GET[op2]=="gift12"){        $gift="`AG`&utschein für ein schönes Essen zu Zwei`At";        $session[user][gold]-=200;        db_query("INSERT INTO items (name,owner,class,gold,description) VALUES ('`AG`&utschein für ein schönes Essen zu Zwei`At`0',$name,'Geschenk',200,'Ein Valentinsgeschenk. Der ist von ".mysqli_real_escape_string($mysqli, $session[user][name])."')");    }    if ($_GET[op2]=="gift13"){        $gift="`AG`Rutschein für ein romantisches Picknic`Ak";        $session[user][gold]-=200;        db_query("INSERT INTO items (name,owner,class,gold,description) VALUES ('`AG`Rutschein für ein romantisches Picknic`Ak`0',$name,'Geschenk',200,'Ein Valentinsgeschenk. Der ist von ".mysqli_real_escape_string($mysqli, $session[user][name])."')");    }    if ($_GET[op2]=="gift14"){        $gift="`\$G`^utschein für ein Dinner bei Kerzenlich`\$t";        $session[user][gold]-=200;        db_query("INSERT INTO items (name,owner,class,gold,description) VALUES ('`\$G`^utschein für ein Dinner bei Kerzenlich`\$t`0',$name,'Geschenk',200,'Ein Valentinsgeschenk. Der ist von ".mysqli_real_escape_string($mysqli, $session[user][name])."')");    }    if ($_GET[op2]=="gift15"){        $gift="`2G`^utschein für extra Streicheleinheite`2n";        $session[user][gold]-=200;        db_query("INSERT INTO items (name,owner,class,gold,description) VALUES ('`2G`^utschein für extra Streicheleinheite`2n`0',$name,'Geschenk',200,'Ein Valentinsgeschenk. Der ist von ".mysqli_real_escape_string($mysqli, $session[user][name])."')");    }    $mailmessage=$session[user][name];    if($_GET[op2]=="gift2") $mailmessage.=" `7 hat dir ein Geschenk geschickt.  Du öffnest es. Es sind `6";    else $mailmessage.=" `7 hat dir ein Geschenk geschickt.  Du öffnest es. Es ist ein/e `6";    $mailmessage.=$gift;    //you can change the following the match what you name your gift shop    $mailmessage.=" `7 aus dem Geschenkeladen.`n".$effekt;    systemmail($name,"`2Geschenk erhalten!`2",$mailmessage);    $out.="`rDein/e $gift `rwurde als Geschenk verschickt!";    if (e_rand(1,3)==2){        $out.=" Bei der Wahl des Geschenks und dem liebevollen Verpacken vergisst du die Zeit und vertrödelst einen Waldkampf.";        $session[user][turns]--;    }    addnav("Weiter","valentineshop.php");}output($out,true);page_footer();

