
<?php/** Version:    09.06.2007* Author:    Linus (schamlos abgeguggt von suhouses.php by anpera und Chaosmaker ;-))* Email:    webmaster@the-legend-of-phoenix.de** Purpose:    Admintool für schnelle Hochzeiten** BETA !!**//*$sql="CREATE TABLE `hzeit` (  `hid` int(11) NOT NULL auto_increment,  `datum` datetime NOT NULL default '0000-00-00 00:00:00',  `status` tinyint(4) NOT NULL default '0',  `macctid` int(11) NOT NULL default '0',  `mann` varchar(255) NOT NULL default '0',  `facctid` int(11) NOT NULL default '0',  `frau` varchar(255) NOT NULL default '0',  `pacctid` int(11) NOT NULL default '0',  `priester` varchar(255) NOT NULL default '0',  PRIMARY KEY  (`hid`)) ENGINE=MyISAM DEFAULT CHARSET=utf8 AUTO_INCREMENT=1";*/require_once "common.php";require_once "func/systemmail.php";require_once "func/isnewday.php";isnewday(1);page_header("Schnellhochzeit");addnav("W?Zurück zum Weltlichen","village.php");addnav("G?Zurück zur Grotte","superuser.php");addnav("Z?Zurück","schnellhochzeit.php");switch($_GET['op']){    case 'drin':        output ("`&ID: ".$_GET['id']."       `&ID2: ".$_GET['mann']."`n");        $sql="SELECT acctid, name FROM accounts WHERE acctid='".$_GET['id']."'";        $frau=db_fetch_assoc(db_query($sql));        $sql="SELECT acctid, name FROM accounts WHERE acctid='".$_GET['mann']."'";        $mann=db_fetch_assoc(db_query($sql));        output($frau['name']." und ".$mann['name']." `&verheiraten?`n");        addnav("Jetzt wirds ernst!");        addnav("Ja - verheiraten!","schnellhochzeit.php?op=save&frau=".$frau['acctid']."&mann=".$mann['acctid']);        break;    case 'save':        $sql="SELECT acctid, name FROM accounts WHERE acctid=".$_GET['frau'];        $frau=db_fetch_assoc(db_query($sql));        $sql="SELECT acctid, name FROM accounts WHERE acctid=".$_GET['mann'];        $mann=db_fetch_assoc(db_query($sql));        $sql="UPDATE accounts SET fragen=10, charisma=4294967295 WHERE acctid=".$_GET['frau']." AND marriedto=".$_GET['mann'];        $result=db_query($sql);        $sql="UPDATE accounts SET fragen=10, charisma=4294967295 WHERE acctid=".$_GET['mann']." AND marriedto=".$_GET['frau'];        $result=db_query($sql);        output($frau['name']." `&und ".$mann['name']." `&sind nun verheiratet.`n");        addnews("`&".$frau['name']." `&und ".$mann['name']."`& haben heute feierlich den Bund der Ehe geschlossen!");        systemmail($frau['acctid'],"`&Ihr seid endlich ein Ehepaar!`0","`& Du und `&".$mann['name']."`& habt nach zahlreichen gemeinsamen Flirts im Garten, endlich geheiratet.`nGlückwunsch!");        systemmail($mann['acctid'],"`&Ihr seid endlich ein Ehepaar!`0","`& Du und `&".$frau['name']."`& habt nach zahlreichen gemeinsamen Flirts im Garten, endlich geheiratet.`nGlückwunsch!");        db_query("INSERT INTO hzeit (datum, macctid, mann, facctid, frau, pacctid, priester, status) VALUES(now(),'".$mann['acctid']."','".$mann['name']."','".$frau['acctid']."','".$frau['name']."','".$session['user']['acctid']."','".$session['user']['name']."','2')");                break;    default:        output("`@`b`cSchnellhochzeit`c`b`n`n");        output("`f`bBitte vor dem Verheiraten daran denken, das Einverständnis beider Hochzeitler einzuholen!`b`n`n");                output('`@wähle die Braut: ');        output('<form action="schnellhochzeit.php?op=drin" method="post">',true);        addnav('','su_pchests.php?op=drin');        output('Springe direkt zu UserId. ');        output('<input type="text" name="id" size="4">',true);        output('<input type="submit" value="anzeigen"></form>',true);        output("Wähle die Brautpaare:`n`n");        output("<table cellpadding=2 align='center'><tr><td>`bUserId.`b</td><td>`bName`b</td><td> und </td><td>`bUserID`b</td><td>`bBräutigam`b</td></tr>",true);        $ppp=25; // Player Per Page +1 to display        if (!$_GET['limit']){            $page=0;        }else{            $page=(int)$_GET['limit'];            addnav("Vorherige Seite","schnellhochzeit.php?limit=".($page-1)."");        }        $limit="".($page*$ppp).",".($ppp+1);        $sql = "SELECT acctid, login, name, marriedto, charisma, fragen, sex FROM accounts WHERE sex='1' AND marriedto!=4294967295 AND charisma>=4 AND fragen>=5 AND fragen<10 ORDER BY acctid ASC LIMIT $limit";        $result = db_query($sql) or die(db_error(LINK));        if (db_num_rows($result)>$ppp) addnav("Nächste Seite","schnellhochzeit.php?limit=".($page+1)."");        if (db_num_rows($result)==0){            output("<tr><td colspan=3 align='center'>`&`iEs gibt keine anstehenden Trauungen`i`0</td></tr>",true);        }else{            for ($i=0;$i<db_num_rows($result);$i++){                $row2 = db_fetch_assoc($result);                $sql2="SELECT acctid, name FROM accounts WHERE acctid=".$row2['marriedto'];                $row3=db_fetch_assoc(db_query($sql2));                output("<tr><td align='center'>".$row2['acctid']."</td><td align='center'><a href='schnellhochzeit.php?op=drin&id=".$row2['acctid']."&mann=".$row3['acctid']."'>".$row2['name']."</td><td> und </td><td>".$row3['acctid']."</td><td>".$row3['name']."</td></tr>",true);                allownav("schnellhochzeit.php?op=drin&id=".$row2['acctid']."&mann=".$row3['acctid']);            }        }        output("</table>",true);}page_footer();?>

